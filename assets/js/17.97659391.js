(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{378:function(e,s,t){"use strict";t.r(s);var a=t(45),n=Object(a.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"failover-testing"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#failover-testing"}},[e._v("#")]),e._v(" Failover Testing")]),e._v(" "),t("p",[e._v("Before failover testing, we have to write some dummy data inside the Redis cluster, we can write the dummy data using the "),t("code",[e._v("redis-cli")]),e._v(".")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it redis-leader-0 -n ot-operators "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    -- redis-cli -a Opstree@1234 -c "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("set")]),e._v(" tony stark\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nDefaulting container name to redis-leader.\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'kubectl describe pod/redis-leader-0 -n ot-operatorsr'")]),e._v(" to see all of the containers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" this pod.\nWarning: Using a password with "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-a'")]),e._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-u'")]),e._v(" option on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" line interface may not be safe.\nOK\n")])])]),t("p",[e._v("Verify the key has been inserted properly by fetching its value.")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it redis-leader-0 -n ot-operators "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    -- redis-cli -a Opstree@1234 -c get tony\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'kubectl describe pod/redis-leader-0 -n ot-operators'")]),e._v(" to see all of the containers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" this pod.\nWarning: Using a password with "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-a'")]),e._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-u'")]),e._v(" option on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" line interface may not be safe.\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"stark"')]),e._v("\n")])])]),t("p",[e._v("Let’s restart the pod name "),t("code",[e._v("redis-leader-0")]),e._v(" and see the redis node behavior.")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl delete pod redis-leader-0 -n ot-operators\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\npod "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"redis-leader-0"')]),e._v(" deleted\n")])])]),t("p",[e._v("Now we can again try to list redis cluster nodes from "),t("code",[e._v("redis-leader-0")]),e._v(" pod and from some other pod as well like:- "),t("code",[e._v("redis-follower-2")])]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it redis-leader-0 -n ot-operators "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    -- redis-cli -a Opstree@1234 cluster nodes\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nDefaulting container name to redis-leader.\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'kubectl describe pod/redis-leader-0 -n ot-operators'")]),e._v(" to see all of the containers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" this pod.\nWarning: Using a password with "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-a'")]),e._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-u'")]),e._v(" option on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" line interface may not be safe.\neef84b7dada737051c32d592bd66652b9af0cb35 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".2.184:6379@16379 slave 0a36dc5064b0a61afa8bd850e93ff0a1c2267704 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958171517")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" connected\na7c424b5ec0e696aa7be15a691846c8820e48cd1 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".1.181:6379@16379 master - "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958172520")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4")]),e._v(" connected "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v("-5460\n118dbe4f49fa224b7d48fbe71990d054c7e9e853 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".0.228:6379@16379 slave 85747fe5cabf96e00fd0365737996a93e05cf947 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958173523")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" connected\n50c3f58a1e2911a68b614f6a1a766cc4a7063e95 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".0.229:6379@16379 myself,slave a7c424b5ec0e696aa7be15a691846c8820e48cd1 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958172000")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("4")]),e._v(" connected\n0a36dc5064b0a61afa8bd850e93ff0a1c2267704 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".1.183:6379@16379 master - "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958173000")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("3")]),e._v(" connected "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10923")]),e._v("-16383\n85747fe5cabf96e00fd0365737996a93e05cf947 "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("10.42")]),e._v(".2.182:6379@16379 master - "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("0")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("1619958173523")]),e._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("2")]),e._v(" connected "),t("span",{pre:!0,attrs:{class:"token number"}},[e._v("5461")]),e._v("-10922\n")])])]),t("p",[e._v("So if you notice the output of cluster nodes command, the node IP is updated and it’s connected as a leader.")]),e._v(" "),t("p",[e._v("Let's try to get value of key from some other pods")]),e._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[e._v("$ kubectl "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("exec")]),e._v(" -it redis-follower-1 -n ot-operators "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("\\")]),e._v("\n    -- redis-cli -a Opstree@1234 -c get tony\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("..")]),e._v(".\nDefaulting container name to redis-follower.\nUse "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'kubectl describe pod/redis-follower-1 -n ot-operators'")]),e._v(" to see all of the containers "),t("span",{pre:!0,attrs:{class:"token keyword"}},[e._v("in")]),e._v(" this pod.\nWarning: Using a password with "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-a'")]),e._v(" or "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v("'-u'")]),e._v(" option on the "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[e._v("command")]),e._v(" line interface may not be safe.\n"),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"stark"')]),e._v("\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);